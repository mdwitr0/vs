## Парсер поисковой выдачи

### 2.1 Исследование API поисковых систем

**Задачи:**
- Изучение Yandex Search API: лимиты, цены, документация
- Изучение Google Custom Search API: лимиты, цены, ограничения
- Сравнительный анализ для выбора основного подхода
- Подготовка запасного варианта через парсинг

**Детали:**
- Yandex Search API: платный, нужно уточнить актуальные тарифы
- Google Custom Search API: 100 запросов бесплатно в день, далее платно ($5 за 1000 запросов)
- Парсинг как fallback: менее стабильно, требует смену proxy и user agents, высокий риск блокировок

**Вопросы для уточнения:**
- Ожидаемый объем запросов в день (предварительно около 100)
- Бюджет на API-запросы
- Важна стабильность или цена?

**Оценка исследования:** 8 часов

### 2.2 Парсер поисковой выдачи

**Реализация через API:**
- Интеграция с Yandex Search API (основной приоритет)
- Интеграция с Google Custom Search API (пока есть вопросы)
- Обработка ответов и извлечение URL
- Rate limiting и квотирование запросов

**Примечание:** Google Custom Search API может иметь ограничения на поиск пиратских сайтов из-за политик Google. Необходимо протестировать эффективность для нашего use case. Основной фокус на Yandex Search API.

**Оценка:** 16-20 часов

**Реализация через парсинг (запасной вариант):**
- HTTP-запросы с ротацией user agents
- Парсинг HTML выдачи
- Обход капчи и антибот-систем
- Система прокси для распределения нагрузки

**Оценка:** 28-40 часов

### 2.3 Система вайтлиста

**Функционал:**
- Хранение доменов второго уровня в базе
- Загрузка вайтлиста через CSV
- API для управления вайтлистом
- Фильтрация результатов поиска перед сохранением

**Структура:**
```json
{
  "domain": "string",
  "added_at": "timestamp",
  "reason": "string"
}
```

**Оценка:** 3 часа

### 2.4 Сервис сбора сайтов из поиска

**Логика:**
- REST endpoint принимает запрос с параметрами: название фильма, поисковая система
- Формирование поискового запроса "<название> смотреть онлайн"
- Получение результатов через API или парсинг
- Фильтрация через вайтлист
- Сохранение новых доменов в базу сайтов
- Создание задачи сканирования для новых сайтов
- Хранение статуса задачи в базе

**Оценка:** 7-10 часов

### 2.5 Фронтенд: страница парсинга поисковой выдачи

**Функционал:**
- Выбор поисковой системы (Яндекс/Google)
- Поле ввода поискового запроса
- Настройка регулярности выполнения
- Кнопка ручного запуска
- Управление вайтлистом с загрузкой CSV
- Отображение прогресса текущего сбора
- История запусков с результатами

**Оценка:** 5-10 часов